# C语言声明分析

C语言声明是十分复杂、晦涩难懂的，正确理解别人代码中的声明和写出自己想表达的声明十分困难。本章介绍一种《c专家编程》提供的循序渐进的方式来解决这个问题。理解C语言声明的关键是记住**声明的优先级规则**，从今以后不再被C语言声明所困扰。

## 优先级规则

A  声明从它的名字开始读取
B   优先级从高到低依次是
1. 申明中被括号括起来的那部分
1. 后缀操作符：
	括号( )表示这是一个函数，而方括号[ ]表示这是一个数组
1. 前缀操作符：
星号 * 表示指向...的指针

C  如果const和volatile关键字的后面紧跟类型说明符（如int，long等），那么它作用于类型说明符。在其他情况下，const和volatile关键字作用于它左边紧邻的指针星号。

接下来我们将使用该优先级规则来分析一些实例

## 实例分析1
我们先看一个简单的例子
```c
char next();
```
大家都知道，上面声明了next是一个函数。而且该函数没有参数，且函数的返回值是一个char类型
##实例分析2
```c
char * next();
```
我们在实例1的基础上再next前面加上了一个星号，这里就产生歧义了。

**解读1：next是一个函数，函数没有参数，且函数的返回值是一个指向char类型的指针**
**解读2：next是一个指向函数的指针，指针指向的函数没有参数，且函数的返回值是一个char类型**

那么以上哪一个解读是正确的呢？我们从优先级规则从高到低看哪一条先满足这个申明，很明显后缀操作符(B-2)优先级高于前缀操作符(B-3)。所以next要先与()结合，那么next就是一个函数，char*就应该看做该函数的返回值。解读1正确。
## 实例分析3
```c
char (* next)();
```
如果我们强制把*与next括在一起，那么B-1优先级生效，解读2正确
##复杂实例
```c
char * const *(*next)()
```
分析：
1. 首先next与\*结合，表明next是一个指针
1. 然后与()结合，表明指向的是一个函数
1. char \* const \* 代表该函数的返回值
1. 根据C规则char \* const \*应该解读为 **指向一个指向char类型常量指针的指针**
最后返回值有点绕，这里再解释一下。
返回值是一个指针，该指针指向一个常量指针。该常量指针指向char类型。
按照C规则const应该是与前缀\*结合而非后缀\*

总结，通过C语言优先级规则，任何复杂的C语言声明都可以非常轻松的读取它表达的意思。从此不再被C语言声明所困扰。